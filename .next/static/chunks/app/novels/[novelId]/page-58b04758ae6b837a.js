(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[568],{3166:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});var s=t(2115),r=t(6203),l=t(6104);function n(){let[e,a]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=(0,r.onAuthStateChanged)(l.j2,e=>{a(e)});return()=>e()},[]),{user:e}}},5695:(e,a,t)=>{"use strict";var s=t(8999);t.o(s,"useParams")&&t.d(a,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})},6104:(e,a,t)=>{"use strict";t.d(a,{CS:()=>u,Gq:()=>o,HS:()=>x,J_:()=>p,Mv:()=>g,Vb:()=>b,YX:()=>v,ab:()=>h,db:()=>d,fC:()=>m,iJ:()=>i,j2:()=>c,qY:()=>y});var s=t(3915),r=t(5317),l=t(6203);let n=(0,s.Wp)({apiKey:"AIzaSyBreQy9u91K6FMTcoY4rl22zNAw_f0juAo",authDomain:"novelplane.firebaseapp.com",projectId:"novelplane",storageBucket:"novelplane.firebasestorage.app",messagingSenderId:"208383799577",appId:"1:208383799577:web:ca27cea78d7588d73e9588"}),d=(0,r.aU)(n),c=(0,l.getAuth)(n);async function i(e,a,t,s){let l=(0,r.H9)(d,"users/".concat(e,"/history"),"".concat(a,"_").concat(t));await (0,r.BN)(l,{novelId:a,chapterId:t,title:s,readAt:(0,r.O5)()})}let o=async(e,a,t)=>{let s=(0,r.H9)(d,"users/".concat(e,"/lastRead"),a);await (0,r.BN)(s,{chapterId:t})},u=async(e,a)=>{let t=(0,r.H9)(d,"users/".concat(e,"/lastRead"),a),s=await (0,r.x7)(t);return s.exists()&&s.data().chapterId||null},h=async()=>(await (0,r.GG)((0,r.rJ)(d,"novels"))).docs.map(e=>({id:e.id,...e.data()})),p=async e=>{let a=(await (0,r.GG)((0,r.rJ)(d,"bookmarks"))).docs.map(e=>({id:e.id,...e.data()})).filter(a=>a.userId===e&&a.novelId).map(e=>e.novelId);return 0===a.length?[]:(await (0,r.GG)((0,r.rJ)(d,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(e=>a.includes(e.id))},x=async()=>{let e=await (0,r.GG)((0,r.rJ)(d,"novels")),a=new Set;return e.docs.forEach(e=>{let t=e.data();Array.isArray(t.tags)&&t.tags.forEach(e=>a.add(e))}),Array.from(a)},g=async e=>(await (0,r.GG)((0,r.rJ)(d,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(a=>Array.isArray(a.tags)&&a.tags.includes(e)),m=async e=>{(0,r.H9)(d,"novels",e);let a=await (0,r.GG)((0,r.rJ)(d,"novels")),t=null;if(a.forEach(a=>{a.id===e&&(t={id:a.id,...a.data()})}),!t)return null;let s=(await (0,r.GG)((0,r.rJ)(d,"novels",e,"chapters"))).docs.map(e=>({id:e.id,...e.data()}));return{...t,chapters:s}},v=async(e,a)=>{(0,r.H9)(d,"novels",e,"chapters",a);let t=await (0,r.GG)((0,r.rJ)(d,"novels",e,"chapters")),s=null;return t.forEach(e=>{e.id===a&&(s={id:e.id,...e.data()})}),s},b=async e=>{let a=(0,r.rJ)(d,"novels",e,"chapters");return(await (0,r.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))},y=async e=>(await (0,r.GG)((0,r.rJ)(d,"users/".concat(e,"/history")))).docs.map(e=>({id:e.id,...e.data()}))},7155:(e,a,t)=>{Promise.resolve().then(t.bind(t,7362))},7362:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var s=t(5155),r=t(5695),l=t(2115),n=t(6104),d=t(3166);function c(){var e,a,t,c,i;let{id:o}=(0,r.useParams)(),u=(0,r.useRouter)(),{user:h}=(0,d.A)(),[p,x]=(0,l.useState)(null),[g,m]=(0,l.useState)(!0),[v,b]=(0,l.useState)(null);return((0,l.useEffect)(()=>{"string"==typeof o&&((0,n.fC)(o).then(e=>{x(e),m(!1)}),h&&(0,n.CS)(h.uid,o).then(e=>{b(e)}))},[o,h]),g)?(0,s.jsx)("p",{className:"p-6 text-center",children:"Loading novel details..."}):p?(0,s.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-6 bg-white dark:bg-gray-900 p-4 rounded-lg shadow",children:[p.cover&&(0,s.jsx)("img",{src:p.cover,alt:p.title,className:"w-full md:w-64 h-auto object-cover rounded"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-blue-700 dark:text-blue-300 mb-2",children:p.title}),(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 mb-2",children:["Author: ",p.author||"Unknown Author"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Chapters: ",(null==(e=p.chapters)?void 0:e.length)||0," | Last updated: ",p.updatedAt||"N/A"]}),(0,s.jsx)("div",{className:"mb-4 flex flex-wrap gap-2",children:null==(a=p.genres)?void 0:a.map(e=>(0,s.jsx)("button",{onClick:()=>u.push("/genres?g=".concat(encodeURIComponent(e))),className:"px-3 py-1 text-xs rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 hover:underline",children:e},e))}),(0,s.jsx)("p",{className:"text-base text-gray-700 dark:text-gray-200 leading-relaxed mb-6",children:p.description||"No description available."}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(null==(t=p.chapters)?void 0:t.length)>0&&(0,s.jsx)("button",{onClick:()=>{var e;if(null==p||null==(e=p.chapters)?void 0:e.length){let e=p.chapters[0].id;u.push("/novels/".concat(p.id,"/chapters/").concat(e))}},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"\uD83D\uDCD6 Read First Chapter"}),v&&(0,s.jsx)("button",{onClick:()=>{v&&u.push("/novels/".concat(p.id,"/chapters/").concat(v))},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition",children:"\uD83D\uDD04 Continue Reading"})]})]})]}),(0,s.jsxs)("div",{className:"mt-10 bg-white dark:bg-gray-900 p-4 rounded-lg shadow",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["\uD83D\uDCD6 Chapters (",(null==(c=p.chapters)?void 0:c.length)||0,")"]}),(null==(i=p.chapters)?void 0:i.length)?(0,s.jsx)("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:p.chapters.map((e,a)=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"/novels/".concat(p.id,"/chapters/").concat(e.id),className:"block py-2 px-3 hover:bg-gray-100 dark:hover:bg-gray-800 rounded transition",children:e.title||"Chapter ".concat(a+1)})},e.id||a))}):(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No chapters available."})]})]}):(0,s.jsx)("p",{className:"p-6 text-center text-red-500",children:"Novel not found."})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,163,645,441,684,358],()=>a(7155)),_N_E=e.O()}]);