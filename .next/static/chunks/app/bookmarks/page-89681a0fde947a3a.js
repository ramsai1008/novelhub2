(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340],{3666:(a,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>c});var s=t(5155),r=t(2115),d=t(6104),n=t(6203),i=t(5695),l=t(5317);let o=async a=>{let e=(await (0,l.GG)((0,l.rJ)(d.db,"bookmarks"))).docs.map(a=>({id:a.id,...a.data()})).filter(e=>e.userId===a&&e.novelId).map(a=>a.novelId);return 0===e.length?[]:(await (0,l.GG)((0,l.rJ)(d.db,"novels"))).docs.map(a=>({id:a.id,...a.data()})).filter(a=>e.includes(a.id))};function c(){let[a,e]=(0,r.useState)(null),[t,l]=(0,r.useState)([]),c=(0,i.useRouter)();return((0,r.useEffect)(()=>{let a=(0,n.onAuthStateChanged)(d.j2,async a=>{a?(e(a),l(await o(a.uid))):c.push("/login")});return()=>a()},[c]),a)?(0,s.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Your Bookmarks"}),0===t.length?(0,s.jsx)("p",{children:"No bookmarks yet."}):(0,s.jsx)("ul",{className:"space-y-2",children:t.map(a=>(0,s.jsxs)("li",{className:"p-3 border rounded shadow-sm",children:[(0,s.jsx)("p",{className:"font-semibold",children:a.title}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Last read: ",a.timestamp?new Date(a.timestamp).toLocaleString():"Unknown"]})]},a.id))})]}):(0,s.jsx)("p",{children:"Loading..."})}},5211:(a,e,t)=>{Promise.resolve().then(t.bind(t,3666))},5695:(a,e,t)=>{"use strict";var s=t(8999);t.o(s,"useParams")&&t.d(e,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(e,{useRouter:function(){return s.useRouter}})},6104:(a,e,t)=>{"use strict";t.d(e,{CS:()=>u,Gq:()=>c,HS:()=>h,J_:()=>m,Mv:()=>f,Vb:()=>w,YX:()=>v,ab:()=>p,db:()=>i,fC:()=>y,iJ:()=>o,j2:()=>l,qY:()=>G});var s=t(3915),r=t(5317),d=t(6203);let n=(0,s.Wp)({apiKey:"AIzaSyBreQy9u91K6FMTcoY4rl22zNAw_f0juAo",authDomain:"novelplane.firebaseapp.com",projectId:"novelplane",storageBucket:"novelplane.firebasestorage.app",messagingSenderId:"208383799577",appId:"1:208383799577:web:ca27cea78d7588d73e9588"}),i=(0,r.aU)(n),l=(0,d.getAuth)(n);async function o(a,e,t,s){let d=(0,r.H9)(i,"users/".concat(a,"/history"),"".concat(e,"_").concat(t));await (0,r.BN)(d,{novelId:e,chapterId:t,title:s,readAt:(0,r.O5)()})}let c=async(a,e,t)=>{let s=(0,r.H9)(i,"users/".concat(a,"/lastRead"),e);await (0,r.BN)(s,{chapterId:t})},u=async(a,e)=>{let t=(0,r.H9)(i,"users/".concat(a,"/lastRead"),e),s=await (0,r.x7)(t);return s.exists()&&s.data().chapterId||null},p=async()=>(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(a=>({id:a.id,...a.data()})),m=async a=>{let e=(await (0,r.GG)((0,r.rJ)(i,"bookmarks"))).docs.map(a=>({id:a.id,...a.data()})).filter(e=>e.userId===a&&e.novelId).map(a=>a.novelId);return 0===e.length?[]:(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(a=>({id:a.id,...a.data()})).filter(a=>e.includes(a.id))},h=async()=>{let a=await (0,r.GG)((0,r.rJ)(i,"novels")),e=new Set;return a.docs.forEach(a=>{let t=a.data();Array.isArray(t.tags)&&t.tags.forEach(a=>e.add(a))}),Array.from(e)},f=async a=>(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(a=>({id:a.id,...a.data()})).filter(e=>Array.isArray(e.tags)&&e.tags.includes(a)),y=async a=>{(0,r.H9)(i,"novels",a);let e=await (0,r.GG)((0,r.rJ)(i,"novels")),t=null;if(e.forEach(e=>{e.id===a&&(t={id:e.id,...e.data()})}),!t)return null;let s=(await (0,r.GG)((0,r.rJ)(i,"novels",a,"chapters"))).docs.map(a=>({id:a.id,...a.data()}));return{...t,chapters:s}},v=async(a,e)=>{(0,r.H9)(i,"novels",a,"chapters",e);let t=await (0,r.GG)((0,r.rJ)(i,"novels",a,"chapters")),s=null;return t.forEach(a=>{a.id===e&&(s={id:a.id,...a.data()})}),s},w=async a=>{let e=(0,r.rJ)(i,"novels",a,"chapters");return(await (0,r.GG)(e)).docs.map(a=>({id:a.id,...a.data()}))},G=async a=>(await (0,r.GG)((0,r.rJ)(i,"users/".concat(a,"/history")))).docs.map(a=>({id:a.id,...a.data()}))}},a=>{var e=e=>a(a.s=e);a.O(0,[992,163,645,441,684,358],()=>e(5211)),_N_E=a.O()}]);