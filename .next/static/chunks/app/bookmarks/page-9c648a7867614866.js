(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340],{3666:(a,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>m});var s=t(5155),r=t(2115),d=t(6104),n=t(6203),l=t(5695),i=t(5317);let c=async a=>{let e=(await (0,i.GG)((0,i.rJ)(d.db,"bookmarks"))).docs.map(a=>({id:a.id,...a.data()})).filter(e=>e.userId===a&&e.novelId).map(a=>a.novelId);return 0===e.length?[]:(await (0,i.GG)((0,i.rJ)(d.db,"novels"))).docs.map(a=>({id:a.id,...a.data()})).filter(a=>e.includes(a.id))};var o=t(6874),u=t.n(o);function m(){let[a,e]=(0,r.useState)(null),[t,i]=(0,r.useState)([]),o=(0,l.useRouter)();return((0,r.useEffect)(()=>{let a=(0,n.onAuthStateChanged)(d.j2,async a=>{a?(e(a),i(await c(a.uid))):o.push("/login")});return()=>a()},[o]),a)?(0,s.jsxs)("div",{className:"max-w-md w-full mx-auto p-4 sm:p-6",children:[(0,s.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-3 sm:mb-4",children:"Your Bookmarks"}),0===t.length?(0,s.jsx)("p",{className:"text-sm",children:"No bookmarks yet."}):(0,s.jsx)("ul",{className:"space-y-2",children:t.map(a=>(0,s.jsxs)("li",{className:"border p-2 sm:p-4 rounded shadow-sm",children:[(0,s.jsx)("span",{className:"font-medium text-sm sm:text-base",children:a.title}),(0,s.jsx)(u(),{href:"/novels/".concat(a.id),className:"ml-2 text-blue-600 underline text-xs sm:text-sm",children:"Read â†’"})]},a.id))})]}):(0,s.jsx)("p",{className:"p-6 text-center text-sm",children:"Loading..."})}},5211:(a,e,t)=>{Promise.resolve().then(t.bind(t,3666))},5695:(a,e,t)=>{"use strict";var s=t(8999);t.o(s,"useParams")&&t.d(e,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(e,{useRouter:function(){return s.useRouter}})},6104:(a,e,t)=>{"use strict";t.d(e,{CS:()=>u,Gq:()=>o,HS:()=>h,J_:()=>p,Mv:()=>f,Vb:()=>y,YX:()=>x,ab:()=>m,db:()=>l,fC:()=>v,iJ:()=>c,j2:()=>i,qY:()=>G});var s=t(3915),r=t(5317),d=t(6203);let n=(0,s.Wp)({apiKey:"AIzaSyBreQy9u91K6FMTcoY4rl22zNAw_f0juAo",authDomain:"novelplane.firebaseapp.com",projectId:"novelplane",storageBucket:"novelplane.firebasestorage.app",messagingSenderId:"208383799577",appId:"1:208383799577:web:ca27cea78d7588d73e9588"}),l=(0,r.aU)(n),i=(0,d.getAuth)(n);async function c(a,e,t,s){let d=(0,r.H9)(l,"users/".concat(a,"/history"),"".concat(e,"_").concat(t));await (0,r.BN)(d,{novelId:e,chapterId:t,title:s,readAt:(0,r.O5)()})}let o=async(a,e,t)=>{let s=(0,r.H9)(l,"users/".concat(a,"/lastRead"),e);await (0,r.BN)(s,{chapterId:t})},u=async(a,e)=>{let t=(0,r.H9)(l,"users/".concat(a,"/lastRead"),e),s=await (0,r.x7)(t);return s.exists()&&s.data().chapterId||null},m=async()=>(await (0,r.GG)((0,r.rJ)(l,"novels"))).docs.map(a=>({id:a.id,...a.data()})),p=async a=>{let e=(await (0,r.GG)((0,r.rJ)(l,"bookmarks"))).docs.map(a=>({id:a.id,...a.data()})).filter(e=>e.userId===a&&e.novelId).map(a=>a.novelId);return 0===e.length?[]:(await (0,r.GG)((0,r.rJ)(l,"novels"))).docs.map(a=>({id:a.id,...a.data()})).filter(a=>e.includes(a.id))},h=async()=>{let a=await (0,r.GG)((0,r.rJ)(l,"novels")),e=new Set;return a.docs.forEach(a=>{let t=a.data();Array.isArray(t.tags)&&t.tags.forEach(a=>e.add(a))}),Array.from(e)},f=async a=>(await (0,r.GG)((0,r.rJ)(l,"novels"))).docs.map(a=>({id:a.id,...a.data()})).filter(e=>Array.isArray(e.tags)&&e.tags.includes(a)),v=async a=>{(0,r.H9)(l,"novels",a);let e=await (0,r.GG)((0,r.rJ)(l,"novels")),t=null;if(e.forEach(e=>{e.id===a&&(t={id:e.id,...e.data()})}),!t)return null;let s=(await (0,r.GG)((0,r.rJ)(l,"novels",a,"chapters"))).docs.map(a=>({id:a.id,...a.data()}));return{...t,chapters:s}},x=async(a,e)=>{(0,r.H9)(l,"novels",a,"chapters",e);let t=await (0,r.GG)((0,r.rJ)(l,"novels",a,"chapters")),s=null;return t.forEach(a=>{a.id===e&&(s={id:a.id,...a.data()})}),s},y=async a=>{let e=(0,r.rJ)(l,"novels",a,"chapters");return(await (0,r.GG)(e)).docs.map(a=>({id:a.id,...a.data()}))},G=async a=>(await (0,r.GG)((0,r.rJ)(l,"users/".concat(a,"/history")))).docs.map(a=>({id:a.id,...a.data()}))}},a=>{var e=e=>a(a.s=e);a.O(0,[992,163,645,874,441,684,358],()=>e(5211)),_N_E=a.O()}]);