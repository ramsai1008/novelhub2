(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{3166:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(2115),r=a(6203),n=a(6104);function l(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=(0,r.onAuthStateChanged)(n.j2,e=>{t(e)});return()=>e()},[]),{user:e}}},5639:(e,t,a)=>{Promise.resolve().then(a.bind(a,9690))},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},6104:(e,t,a)=>{"use strict";a.d(t,{CS:()=>u,Gq:()=>c,HS:()=>p,J_:()=>h,Mv:()=>x,Vb:()=>f,YX:()=>b,ab:()=>m,db:()=>i,fC:()=>g,iJ:()=>d,j2:()=>o,qY:()=>w});var s=a(3915),r=a(5317),n=a(6203);let l=(0,s.Wp)({apiKey:"AIzaSyBreQy9u91K6FMTcoY4rl22zNAw_f0juAo",authDomain:"novelplane.firebaseapp.com",projectId:"novelplane",storageBucket:"novelplane.firebasestorage.app",messagingSenderId:"208383799577",appId:"1:208383799577:web:ca27cea78d7588d73e9588"}),i=(0,r.aU)(l),o=(0,n.getAuth)(l);async function d(e,t,a,s){let n=(0,r.doc)(i,"users/".concat(e,"/history"),"".concat(t,"_").concat(a));await (0,r.BN)(n,{novelId:t,chapterId:a,title:s,readAt:(0,r.O5)()})}let c=async(e,t,a)=>{let s=(0,r.doc)(i,"users/".concat(e,"/lastRead"),t);await (0,r.BN)(s,{chapterId:a})},u=async(e,t)=>{let a=(0,r.doc)(i,"users/".concat(e,"/lastRead"),t),s=await (0,r.getDoc)(a);return s.exists()&&s.data().chapterId||null},m=async()=>(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})),h=async e=>{let t=(await (0,r.GG)((0,r.rJ)(i,"bookmarks"))).docs.map(e=>({id:e.id,...e.data()})).filter(t=>t.userId===e&&t.novelId).map(e=>e.novelId);return 0===t.length?[]:(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(e=>t.includes(e.id))},p=async()=>{let e=await (0,r.GG)((0,r.rJ)(i,"novels")),t=new Set;return e.docs.forEach(e=>{let a=e.data();Array.isArray(a.tags)&&a.tags.forEach(e=>t.add(e))}),Array.from(t)},x=async e=>(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(t=>Array.isArray(t.tags)&&t.tags.includes(e)),g=async e=>{(0,r.doc)(i,"novels",e);let t=await (0,r.GG)((0,r.rJ)(i,"novels")),a=null;if(t.forEach(t=>{t.id===e&&(a={id:t.id,...t.data()})}),!a)return null;let s=(await (0,r.GG)((0,r.rJ)(i,"novels",e,"chapters"))).docs.map(e=>({id:e.id,...e.data()}));return{...a,chapters:s}},b=async(e,t)=>{(0,r.doc)(i,"novels",e,"chapters",t);let a=await (0,r.GG)((0,r.rJ)(i,"novels",e,"chapters")),s=null;return a.forEach(e=>{e.id===t&&(s={id:e.id,...e.data()})}),s},f=async e=>{let t=(0,r.rJ)(i,"novels",e,"chapters");return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},w=async e=>(await (0,r.GG)((0,r.rJ)(i,"users/".concat(e,"/history")))).docs.map(e=>({id:e.id,...e.data()}))},9690:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(5155),r=a(6203),n=a(6104),l=a(5317),i=a(5695),o=a(2115),d=a(3166);function c(){let e=(0,i.useRouter)(),{user:t}=(0,d.A)(),[a,c]=(0,o.useState)(""),[u,m]=(0,o.useState)(""),[h,p]=(0,o.useState)(null),[x,g]=(0,o.useState)(!1),[b,f]=(0,o.useState)(""),[w,v]=(0,o.useState)(null),[y,j]=(0,o.useState)(""),[N,G]=(0,o.useState)(""),[A,S]=(0,o.useState)(null);(0,o.useEffect)(()=>{t&&e.push("/")},[t,e]);let E=async()=>{let e=new r.GoogleAuthProvider;try{await (0,r.signInWithPopup)(n.j2,e)}catch(e){console.error("Login error:",e),p("Google login failed.")}},I=async e=>{e.preventDefault(),p(null);try{await (0,r.signInWithEmailAndPassword)(n.j2,a,u)}catch(e){p("Invalid email or password.")}},P=async t=>{if(t.preventDefault(),S(null),"ramsai0014@gmail.com"!==y)return void S("Access denied. Not an admin email.");try{let t=await (0,r.signInWithEmailAndPassword)(n.j2,y,N),a=await (0,l.getDoc)((0,l.doc)(n.db,"users",t.user.uid));if(!a.exists()||!a.data().isAdmin)return void S("Access denied. Not an admin user.");e.push("/admin")}catch(e){S("Admin login failed.")}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 px-2 sm:px-0",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-8 rounded shadow-md w-full max-w-xs sm:max-w-md",children:[(0,s.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-center",children:"Sign In"}),h&&(0,s.jsx)("div",{className:"mb-3 sm:mb-4 text-red-500 text-center text-sm",children:h}),(0,s.jsxs)("form",{onSubmit:I,className:"mb-3 sm:mb-4",children:[(0,s.jsx)("input",{type:"email",placeholder:"Email",value:a,onChange:e=>c(e.target.value),className:"w-full mb-2 sm:mb-3 px-3 py-2 border rounded focus:outline-none focus:ring text-sm",required:!0}),(0,s.jsx)("input",{type:"password",placeholder:"Password",value:u,onChange:e=>m(e.target.value),className:"w-full mb-2 sm:mb-4 px-3 py-2 border rounded focus:outline-none focus:ring text-sm",required:!0}),(0,s.jsx)("div",{className:"mb-2 text-right",children:(0,s.jsx)("button",{type:"button",className:"text-xs text-blue-600 hover:underline",onClick:()=>g(!0),children:"Forgot password?"})}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 mb-2 text-sm sm:text-base",children:"Sign in with Email"})]}),(0,s.jsxs)("button",{onClick:E,className:"w-full flex items-center justify-center gap-2 sm:gap-3 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 text-sm sm:text-base",children:[(0,s.jsx)("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google icon",className:"w-4 h-4 sm:w-5 sm:h-5"}),"Sign in with Google"]}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm mt-3 sm:mt-4 text-center",children:["Don't have an account? ",(0,s.jsx)("a",{href:"/register",className:"text-blue-600 hover:underline",children:"Register here"})]}),(0,s.jsxs)("div",{className:"mt-6 border-t pt-4",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold mb-2 text-center",children:"Admin Login"}),(0,s.jsxs)("form",{onSubmit:P,className:"mb-3 sm:mb-4 bg-gray-50 dark:bg-gray-700 p-3 sm:p-4 rounded",children:[(0,s.jsx)("input",{type:"email",placeholder:"Admin Email",value:y,onChange:e=>j(e.target.value),className:"w-full mb-2 sm:mb-3 px-3 py-2 border rounded focus:outline-none focus:ring text-sm",required:!0}),(0,s.jsx)("input",{type:"password",placeholder:"Admin Password",value:N,onChange:e=>G(e.target.value),className:"w-full mb-2 sm:mb-4 px-3 py-2 border rounded focus:outline-none focus:ring text-sm",required:!0}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 mb-2 text-sm sm:text-base",children:"Admin Login"}),A&&(0,s.jsx)("div",{className:"mb-2 text-red-500 text-center text-xs sm:text-sm",children:A})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,163,645,441,684,358],()=>t(5639)),_N_E=e.O()}]);