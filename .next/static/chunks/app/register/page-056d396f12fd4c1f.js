(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{3166:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});var s=t(2115),r=t(6203),n=t(6104);function l(){let[e,a]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=(0,r.onAuthStateChanged)(n.j2,e=>{a(e)});return()=>e()},[]),{user:e}}},3291:(e,a,t)=>{Promise.resolve().then(t.bind(t,6616))},5695:(e,a,t)=>{"use strict";var s=t(8999);t.o(s,"useParams")&&t.d(a,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})},6104:(e,a,t)=>{"use strict";t.d(a,{CS:()=>u,Gq:()=>d,HS:()=>h,J_:()=>p,Mv:()=>g,Vb:()=>b,YX:()=>w,ab:()=>m,db:()=>o,fC:()=>f,iJ:()=>c,j2:()=>i,qY:()=>x});var s=t(3915),r=t(5317),n=t(6203);let l=(0,s.Wp)({apiKey:"AIzaSyBreQy9u91K6FMTcoY4rl22zNAw_f0juAo",authDomain:"novelplane.firebaseapp.com",projectId:"novelplane",storageBucket:"novelplane.firebasestorage.app",messagingSenderId:"208383799577",appId:"1:208383799577:web:ca27cea78d7588d73e9588"}),o=(0,r.aU)(l),i=(0,n.getAuth)(l);async function c(e,a,t,s){let n=(0,r.doc)(o,"users/".concat(e,"/history"),"".concat(a,"_").concat(t));await (0,r.BN)(n,{novelId:a,chapterId:t,title:s,readAt:(0,r.O5)()})}let d=async(e,a,t)=>{let s=(0,r.doc)(o,"users/".concat(e,"/lastRead"),a);await (0,r.BN)(s,{chapterId:t})},u=async(e,a)=>{let t=(0,r.doc)(o,"users/".concat(e,"/lastRead"),a),s=await (0,r.getDoc)(t);return s.exists()&&s.data().chapterId||null},m=async()=>(await (0,r.GG)((0,r.rJ)(o,"novels"))).docs.map(e=>({id:e.id,...e.data()})),p=async e=>{let a=(await (0,r.GG)((0,r.rJ)(o,"bookmarks"))).docs.map(e=>({id:e.id,...e.data()})).filter(a=>a.userId===e&&a.novelId).map(e=>e.novelId);return 0===a.length?[]:(await (0,r.GG)((0,r.rJ)(o,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(e=>a.includes(e.id))},h=async()=>{let e=await (0,r.GG)((0,r.rJ)(o,"novels")),a=new Set;return e.docs.forEach(e=>{let t=e.data();Array.isArray(t.tags)&&t.tags.forEach(e=>a.add(e))}),Array.from(a)},g=async e=>(await (0,r.GG)((0,r.rJ)(o,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(a=>Array.isArray(a.tags)&&a.tags.includes(e)),f=async e=>{(0,r.doc)(o,"novels",e);let a=await (0,r.GG)((0,r.rJ)(o,"novels")),t=null;if(a.forEach(a=>{a.id===e&&(t={id:a.id,...a.data()})}),!t)return null;let s=(await (0,r.GG)((0,r.rJ)(o,"novels",e,"chapters"))).docs.map(e=>({id:e.id,...e.data()}));return{...t,chapters:s}},w=async(e,a)=>{(0,r.doc)(o,"novels",e,"chapters",a);let t=await (0,r.GG)((0,r.rJ)(o,"novels",e,"chapters")),s=null;return t.forEach(e=>{e.id===a&&(s={id:e.id,...e.data()})}),s},b=async e=>{let a=(0,r.rJ)(o,"novels",e,"chapters");return(await (0,r.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))},x=async e=>(await (0,r.GG)((0,r.rJ)(o,"users/".concat(e,"/history")))).docs.map(e=>({id:e.id,...e.data()}))},6616:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var s=t(5155),r=t(6203),n=t(6104),l=t(5695),o=t(2115),i=t(3166);function c(){let e=(0,l.useRouter)(),{user:a}=(0,i.A)(),[t,c]=(0,o.useState)(""),[d,u]=(0,o.useState)(""),[m,p]=(0,o.useState)(null);(0,o.useEffect)(()=>{a&&e.push("/")},[a,e]);let h=async()=>{try{await (0,r.signInWithPopup)(n.j2,new r.GoogleAuthProvider)}catch(e){console.error("Registration failed:",e)}},g=async e=>{e.preventDefault(),p(null);try{await (0,r.createUserWithEmailAndPassword)(n.j2,t,d)}catch(e){p(e.message||"Registration failed.")}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 px-2 sm:px-0",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-8 rounded shadow-md w-full max-w-xs sm:max-w-md",children:[(0,s.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-center",children:"Register"}),(0,s.jsxs)("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 sm:gap-3 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 text-sm sm:text-base",children:[(0,s.jsx)("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google icon",className:"w-4 h-4 sm:w-5 sm:h-5"}),"Register with Google"]}),(0,s.jsxs)("form",{onSubmit:g,className:"mb-3 sm:mb-4",children:[(0,s.jsx)("input",{type:"email",placeholder:"Email",value:t,onChange:e=>c(e.target.value),className:"w-full mb-2 sm:mb-3 px-3 py-2 border rounded focus:outline-none focus:ring text-sm",required:!0}),(0,s.jsx)("input",{type:"password",placeholder:"Password",value:d,onChange:e=>u(e.target.value),className:"w-full mb-2 sm:mb-4 px-3 py-2 border rounded focus:outline-none focus:ring text-sm",required:!0}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 mb-2 text-sm sm:text-base",children:"Register with Email"})]}),m&&(0,s.jsx)("div",{className:"mb-3 sm:mb-4 text-red-500 text-center text-sm",children:m})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,163,645,441,684,358],()=>a(3291)),_N_E=e.O()}]);