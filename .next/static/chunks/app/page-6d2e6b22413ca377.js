(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3166:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(2115),r=a(6203),l=a(6104);function d(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=(0,r.onAuthStateChanged)(l.j2,e=>{t(e)});return()=>e()},[]),{user:e}}},3792:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(5155),r=a(2115),l=a(6874),d=a.n(l),i=a(6104),c=a(3166),n=a(4878);function o(){var e;let[t,a]=(0,r.useState)([]),[l,o]=(0,r.useState)([]),[m,x]=(0,r.useState)(!0),[h,u]=(0,r.useState)([]),{user:p}=(0,c.A)(),{searchTerm:g}=(0,r.useContext)(n.o);(0,r.useEffect)(()=>{(async()=>{let e=await (0,i.ab)();a(e),x(!1),p&&o(await (0,i.J_)(p.uid));let t=[];for(let a of e){let e=await (0,i.Vb)(a.id);if(e&&e.length>0){let s=e.reduce((e,t)=>e.createdAt>t.createdAt?e:t);t.push({novelId:a.id,novelTitle:a.title,chapterId:s.id,chapterTitle:s.title,chapterNumber:e.findIndex(e=>e.id===s.id)+1,updatedAt:s.createdAt})}}let s=Date.now();(t=t.filter(e=>e.updatedAt&&s-e.updatedAt<=2592e6)).sort((e,t)=>(t.updatedAt||0)-(e.updatedAt||0)),u(t.slice(0,20))})()},[p]);let v=t.filter(e=>e.title.toLowerCase().includes(g.toLowerCase()));return(0,s.jsxs)("div",{className:"px-2 py-4 sm:px-4 sm:py-6 max-w-7xl mx-auto",children:[p&&l.length>0&&(0,s.jsxs)("div",{className:"mb-8 sm:mb-10",children:[(0,s.jsx)("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4",children:"\uD83D\uDCCC Continue Reading"}),(0,s.jsx)("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 sm:gap-4",children:l.map(e=>(0,s.jsx)(d(),{href:"/novels/".concat(e.id),children:(0,s.jsx)("div",{className:"p-3 sm:p-4 bg-white dark:bg-gray-900 rounded shadow hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:(0,s.jsx)("p",{className:"text-xs sm:text-sm font-medium truncate",children:e.title})})},e.id))})]}),(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold mb-3 sm:mb-4",children:"\uD83C\uDFAF Featured Novels"}),(0,s.jsx)("div",{className:"w-full overflow-x-auto",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-11 gap-2 sm:gap-4 min-h-[200px]",children:[(0,s.jsx)("div",{className:"sm:col-span-5 row-span-2",children:v[0]?(0,s.jsx)(d(),{href:"/novels/".concat(v[0].id),children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow hover:shadow-lg transition h-full flex flex-col",children:[v[0].cover&&(0,s.jsx)("img",{src:v[0].cover,alt:v[0].title,className:"w-full h-48 sm:h-80 object-cover rounded-t-lg"}),(0,s.jsxs)("div",{className:"p-3 flex-1 flex flex-col",children:[(0,s.jsx)("h3",{className:"font-bold text-lg sm:text-xl mb-1 truncate",children:v[0].title}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 line-clamp-3",children:[null==(e=v[0].description)?void 0:e.slice(0,120),"..."]})]})]})}):(0,s.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg h-full flex items-center justify-center min-h-[200px]",children:"No featured novel"})}),(0,s.jsx)("div",{className:"sm:col-span-3 flex sm:flex-col flex-row gap-2",children:[1,2,3,4,5].map(e=>{var t;return v[e]?(0,s.jsx)(d(),{href:"/novels/".concat(v[e].id),children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded shadow hover:shadow-lg transition flex items-center gap-2 p-2 min-w-[120px]",children:[v[e].cover&&(0,s.jsx)("img",{src:v[e].cover,alt:v[e].title,className:"w-12 h-16 object-cover rounded"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-xs sm:text-sm truncate",children:v[e].title}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[null==(t=v[e].description)?void 0:t.slice(0,40),"..."]})]})]})},v[e].id):(0,s.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded flex items-center justify-center h-16 min-w-[120px]",children:"Empty"},e)})}),(0,s.jsx)("div",{className:"sm:col-span-3 flex sm:flex-col flex-row gap-2",children:[6,7,8,9,10].map(e=>{var t;return v[e]?(0,s.jsx)(d(),{href:"/novels/".concat(v[e].id),children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded shadow hover:shadow-lg transition flex items-center gap-2 p-2 min-w-[120px]",children:[v[e].cover&&(0,s.jsx)("img",{src:v[e].cover,alt:v[e].title,className:"w-12 h-16 object-cover rounded"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-xs sm:text-sm truncate",children:v[e].title}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[null==(t=v[e].description)?void 0:t.slice(0,40),"..."]})]})]})},v[e].id):(0,s.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded flex items-center justify-center h-16 min-w-[120px]",children:"Empty"},e)})})]})}),(0,s.jsxs)("div",{className:"mt-10",children:[(0,s.jsx)("h2",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4",children:"\uD83D\uDCE2 Latest Updated Chapters"}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-900 rounded shadow p-3 sm:p-4",children:0===h.length?(0,s.jsx)("div",{className:"text-gray-500 text-sm",children:"No recent updates."}):(0,s.jsx)("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:h.map((e,t)=>(0,s.jsxs)("li",{className:"py-2 flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-4",children:[(0,s.jsx)(d(),{href:"/novels/".concat(e.novelId),className:"font-semibold text-blue-700 dark:text-blue-400 hover:underline text-sm sm:text-base truncate max-w-xs sm:max-w-sm",children:e.novelTitle}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Ch. ",e.chapterNumber,": ",e.chapterTitle]}),(0,s.jsx)("span",{className:"text-xs text-gray-400 ml-auto",children:e.updatedAt?new Date(e.updatedAt).toLocaleString():""})]},e.novelId+e.chapterId))})})]}),!m&&0===v.length&&(0,s.jsxs)("p",{className:"text-center text-gray-500 mt-8 sm:mt-10 text-sm sm:text-base",children:["No novels found for “",g,"”"]})]})}},4878:(e,t,a)=>{"use strict";a.d(t,{Y:()=>d,o:()=>l});var s=a(5155),r=a(2115);let l=(0,r.createContext)({searchTerm:"",setSearchTerm:e=>{}});function d(e){let{children:t}=e,[a,d]=(0,r.useState)("");return(0,s.jsx)(l.Provider,{value:{searchTerm:a,setSearchTerm:d},children:t})}},6104:(e,t,a)=>{"use strict";a.d(t,{CS:()=>m,Gq:()=>o,HS:()=>u,J_:()=>h,Mv:()=>p,Vb:()=>f,YX:()=>v,ab:()=>x,db:()=>i,fC:()=>g,iJ:()=>n,j2:()=>c,qY:()=>y});var s=a(3915),r=a(5317),l=a(6203);let d=(0,s.Wp)({apiKey:"AIzaSyBreQy9u91K6FMTcoY4rl22zNAw_f0juAo",authDomain:"novelplane.firebaseapp.com",projectId:"novelplane",storageBucket:"novelplane.firebasestorage.app",messagingSenderId:"208383799577",appId:"1:208383799577:web:ca27cea78d7588d73e9588"}),i=(0,r.aU)(d),c=(0,l.getAuth)(d);async function n(e,t,a,s){let l=(0,r.doc)(i,"users/".concat(e,"/history"),"".concat(t,"_").concat(a));await (0,r.BN)(l,{novelId:t,chapterId:a,title:s,readAt:(0,r.O5)()})}let o=async(e,t,a)=>{let s=(0,r.doc)(i,"users/".concat(e,"/lastRead"),t);await (0,r.BN)(s,{chapterId:a})},m=async(e,t)=>{let a=(0,r.doc)(i,"users/".concat(e,"/lastRead"),t),s=await (0,r.getDoc)(a);return s.exists()&&s.data().chapterId||null},x=async()=>(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})),h=async e=>{let t=(await (0,r.GG)((0,r.rJ)(i,"bookmarks"))).docs.map(e=>({id:e.id,...e.data()})).filter(t=>t.userId===e&&t.novelId).map(e=>e.novelId);return 0===t.length?[]:(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(e=>t.includes(e.id))},u=async()=>{let e=await (0,r.GG)((0,r.rJ)(i,"novels")),t=new Set;return e.docs.forEach(e=>{let a=e.data();Array.isArray(a.tags)&&a.tags.forEach(e=>t.add(e))}),Array.from(t)},p=async e=>(await (0,r.GG)((0,r.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(t=>Array.isArray(t.tags)&&t.tags.includes(e)),g=async e=>{(0,r.doc)(i,"novels",e);let t=await (0,r.GG)((0,r.rJ)(i,"novels")),a=null;if(t.forEach(t=>{t.id===e&&(a={id:t.id,...t.data()})}),!a)return null;let s=(await (0,r.GG)((0,r.rJ)(i,"novels",e,"chapters"))).docs.map(e=>({id:e.id,...e.data()}));return{...a,chapters:s}},v=async(e,t)=>{(0,r.doc)(i,"novels",e,"chapters",t);let a=await (0,r.GG)((0,r.rJ)(i,"novels",e,"chapters")),s=null;return a.forEach(e=>{e.id===t&&(s={id:e.id,...e.data()})}),s},f=async e=>{let t=(0,r.rJ)(i,"novels",e,"chapters");return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},y=async e=>(await (0,r.GG)((0,r.rJ)(i,"users/".concat(e,"/history")))).docs.map(e=>({id:e.id,...e.data()}))},8719:(e,t,a)=>{Promise.resolve().then(a.bind(a,3792))}},e=>{var t=t=>e(e.s=t);e.O(0,[992,163,645,874,441,684,358],()=>t(8719)),_N_E=e.O()}]);