(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},3166:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(2115),s=a(6203),n=a(6104);function l(){let[e,t]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=(0,s.onAuthStateChanged)(n.j2,e=>{t(e)});return()=>e()},[]),{user:e}}},4878:(e,t,a)=>{"use strict";a.d(t,{Y:()=>l,o:()=>n});var r=a(5155),s=a(2115);let n=(0,s.createContext)({searchTerm:"",setSearchTerm:e=>{}});function l(e){let{children:t}=e,[a,l]=(0,s.useState)("");return(0,r.jsx)(n.Provider,{value:{searchTerm:a,setSearchTerm:l},children:t})}},5149:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var r=a(5155);a(347);var s=a(6874),n=a.n(s),l=a(8346),i=a.n(l),o=a(2115);let c=(0,o.createContext)({theme:"light",toggleTheme:()=>{}});function d(e){let{children:t}=e,[a,s]=(0,o.useState)("light");return(0,o.useEffect)(()=>{let e=localStorage.getItem("theme");e&&s(e)},[]),(0,o.useEffect)(()=>{localStorage.setItem("theme",a),document.documentElement.classList.toggle("dark","dark"===a)},[a]),(0,r.jsx)(c.Provider,{value:{theme:a,toggleTheme:()=>s(e=>"light"===e?"dark":"light")},children:t})}let h=()=>(0,o.useContext)(c);var u=a(4878),m=a(2098),x=a(3509),g=a(8704);function f(){let{theme:e,toggleTheme:t}=h(),a="dark"===e;return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.A,{className:"w-5 h-5 text-yellow-500"}),(0,r.jsx)(g.dO,{checked:a,onChange:t,className:"".concat(a?"bg-gray-800":"bg-gray-300","\n          relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-300"),children:(0,r.jsx)("span",{className:"".concat(a?"translate-x-6 bg-white":"translate-x-1 bg-black"," inline-block h-4 w-4 transform rounded-full transition-transform")})}),(0,r.jsx)(x.A,{className:"w-5 h-5 text-gray-800 dark:text-white"})]})}var v=a(3166),p=a(6104),w=a(6203),b=a(5695);function y(){let e=(0,b.useRouter)(),t=async()=>{await (0,w.signOut)(p.j2),e.push("/login")};return(0,r.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border rounded bg-white dark:bg-zinc-900 text-black dark:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 transition",children:"Sign Out"})}function j(){let{user:e}=(0,v.A)();return e?(0,r.jsx)(y,{}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n(),{href:"/login",className:"px-3 py-2 rounded bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 transition text-sm sm:text-base",children:"Login"})})}function k(e){let{searchTerm:t,setSearchTerm:a}=e;return(0,r.jsxs)("div",{className:"relative max-w-xl mx-auto mb-6",children:[(0,r.jsx)("svg",{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400 dark:text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35M11 18a7 7 0 100-14 7 7 0 000 14z"})}),(0,r.jsx)("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:"Search novels by title...",className:"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white dark:border-gray-600"})]})}function N(e){let{children:t}=e,{user:s}=(0,v.A)(),[l,c]=(0,o.useState)(!1),[h,m]=(0,o.useState)(""),x=(0,b.useRouter)();return(0,o.useEffect)(()=>{!async function(){if(s){let{getDoc:e,doc:t}=await Promise.resolve().then(a.bind(a,5317)),{db:r}=await Promise.resolve().then(a.bind(a,6104)),n=await e(t(r,"users",s.uid));c(!!n.exists()&&!!n.data().isAdmin)}else c(!1)}()},[s]),(0,r.jsxs)("html",{lang:"en",children:[(0,r.jsx)("head",{children:(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})}),(0,r.jsx)("body",{className:"".concat(i().className," bg-white dark:bg-black text-black dark:text-white transition-colors min-h-screen"),children:(0,r.jsx)(d,{children:(0,r.jsxs)(u.Y,{children:[(0,r.jsxs)("nav",{className:"p-4 bg-gradient-to-r from-blue-700 via-indigo-600 to-purple-600 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex justify-between items-center shadow-lg",children:[(0,r.jsxs)("div",{className:"space-x-4 flex items-center",children:[(0,r.jsx)(n(),{href:"/",className:"hover:underline text-white font-bold tracking-wide text-lg",children:"Home"}),(0,r.jsx)(n(),{href:"/bookmarks",className:"hover:underline text-white/90",children:"Bookmarks"}),(0,r.jsx)(n(),{href:"/history",className:"hover:underline text-white/90",children:"History"}),(0,r.jsx)(n(),{href:"/dashboard",className:"hover:underline text-white/90",children:"Dashboard"}),l&&(0,r.jsx)(n(),{href:"/admin",className:"hover:underline text-yellow-300 font-bold",children:"Admin"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("form",{onSubmit:function(e){e.preventDefault(),0!==h.trim().length&&x.push("/search?query=".concat(encodeURIComponent(h.trim())))},className:"flex items-center",children:(0,r.jsx)(k,{searchTerm:h,setSearchTerm:m})}),(0,r.jsx)(f,{}),(0,r.jsx)(j,{})]})]}),(0,r.jsx)("main",{className:"p-4",children:(0,r.jsx)(o.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading..."}),children:t})})]})})})]})}},5638:(e,t,a)=>{Promise.resolve().then(a.bind(a,5149))},6104:(e,t,a)=>{"use strict";a.d(t,{CS:()=>h,Gq:()=>d,HS:()=>x,J_:()=>m,Mv:()=>g,Vb:()=>p,YX:()=>v,ab:()=>u,db:()=>i,fC:()=>f,iJ:()=>c,j2:()=>o,qY:()=>w});var r=a(3915),s=a(5317),n=a(6203);let l=(0,r.Wp)({apiKey:"AIzaSyBreQy9u91K6FMTcoY4rl22zNAw_f0juAo",authDomain:"novelplane.firebaseapp.com",projectId:"novelplane",storageBucket:"novelplane.firebasestorage.app",messagingSenderId:"208383799577",appId:"1:208383799577:web:ca27cea78d7588d73e9588"}),i=(0,s.aU)(l),o=(0,n.getAuth)(l);async function c(e,t,a,r){let n=(0,s.doc)(i,"users/".concat(e,"/history"),"".concat(t,"_").concat(a));await (0,s.BN)(n,{novelId:t,chapterId:a,title:r,readAt:(0,s.O5)()})}let d=async(e,t,a)=>{let r=(0,s.doc)(i,"users/".concat(e,"/lastRead"),t);await (0,s.BN)(r,{chapterId:a})},h=async(e,t)=>{let a=(0,s.doc)(i,"users/".concat(e,"/lastRead"),t),r=await (0,s.getDoc)(a);return r.exists()&&r.data().chapterId||null},u=async()=>(await (0,s.GG)((0,s.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})),m=async e=>{let t=(await (0,s.GG)((0,s.rJ)(i,"bookmarks"))).docs.map(e=>({id:e.id,...e.data()})).filter(t=>t.userId===e&&t.novelId).map(e=>e.novelId);return 0===t.length?[]:(await (0,s.GG)((0,s.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(e=>t.includes(e.id))},x=async()=>{let e=await (0,s.GG)((0,s.rJ)(i,"novels")),t=new Set;return e.docs.forEach(e=>{let a=e.data();Array.isArray(a.tags)&&a.tags.forEach(e=>t.add(e))}),Array.from(t)},g=async e=>(await (0,s.GG)((0,s.rJ)(i,"novels"))).docs.map(e=>({id:e.id,...e.data()})).filter(t=>Array.isArray(t.tags)&&t.tags.includes(e)),f=async e=>{(0,s.doc)(i,"novels",e);let t=await (0,s.GG)((0,s.rJ)(i,"novels")),a=null;if(t.forEach(t=>{t.id===e&&(a={id:t.id,...t.data()})}),!a)return null;let r=(await (0,s.GG)((0,s.rJ)(i,"novels",e,"chapters"))).docs.map(e=>({id:e.id,...e.data()}));return{...a,chapters:r}},v=async(e,t)=>{(0,s.doc)(i,"novels",e,"chapters",t);let a=await (0,s.GG)((0,s.rJ)(i,"novels",e,"chapters")),r=null;return a.forEach(e=>{e.id===t&&(r={id:e.id,...e.data()})}),r},p=async e=>{let t=(0,s.rJ)(i,"novels",e,"chapters");return(await (0,s.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},w=async e=>(await (0,s.GG)((0,s.rJ)(i,"users/".concat(e,"/history")))).docs.map(e=>({id:e.id,...e.data()}))}},e=>{var t=t=>e(e.s=t);e.O(0,[838,992,163,645,874,100,441,684,358],()=>t(5638)),_N_E=e.O()}]);